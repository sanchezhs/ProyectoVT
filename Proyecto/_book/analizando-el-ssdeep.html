<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Analizando el ssdeep | Virus Total</title>
  <meta name="description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Analizando el ssdeep | Virus Total" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  <meta name="github-repo" content="https://github.com/samuel-uma/ProyectoVT" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Analizando el ssdeep | Virus Total" />
  
  <meta name="twitter:description" content="<p>This is a minimal example of using the bookdown package to write a book.
The HTML output format for this example is bookdown::gitbook,
set in the _output.yml file.</p>" />
  

<meta name="author" content="Samuel Sánchez Toca y Alejandro Medina Astorga" />


<meta name="date" content="2022-05-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="cross.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> url: your book url like <span>https://bookdown.org/yihui/bookdown</span></a>
<ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#inicio"><i class="fa fa-check"></i><b>1.1</b> Inicio</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#renombrando-los-archivos"><i class="fa fa-check"></i><b>1.2</b> Renombrando los archivos</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#datos-iniciales"><i class="fa fa-check"></i><b>1.3</b> Datos iniciales</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="analizando-el-ssdeep.html"><a href="analizando-el-ssdeep.html"><i class="fa fa-check"></i><b>2</b> Analizando el <em>ssdeep</em></a>
<ul>
<li class="chapter" data-level="2.1" data-path="analizando-el-ssdeep.html"><a href="analizando-el-ssdeep.html#sample1.c"><i class="fa fa-check"></i><b>2.1</b> sample1.c</a></li>
<li class="chapter" data-level="2.2" data-path="analizando-el-ssdeep.html"><a href="analizando-el-ssdeep.html#sample2.c"><i class="fa fa-check"></i><b>2.2</b> sample2.c</a></li>
<li class="chapter" data-level="2.3" data-path="analizando-el-ssdeep.html"><a href="analizando-el-ssdeep.html#sample3.c"><i class="fa fa-check"></i><b>2.3</b> sample3.c</a></li>
<li class="chapter" data-level="2.4" data-path="analizando-el-ssdeep.html"><a href="analizando-el-ssdeep.html#analizando-los-json"><i class="fa fa-check"></i><b>2.4</b> Analizando los json</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="cross.html"><a href="cross.html"><i class="fa fa-check"></i><b>3</b> Cross-references</a>
<ul>
<li class="chapter" data-level="3.1" data-path="cross.html"><a href="cross.html#chapters-and-sub-chapters"><i class="fa fa-check"></i><b>3.1</b> Chapters and sub-chapters</a></li>
<li class="chapter" data-level="3.2" data-path="cross.html"><a href="cross.html#captioned-figures-and-tables"><i class="fa fa-check"></i><b>3.2</b> Captioned figures and tables</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="parts.html"><a href="parts.html"><i class="fa fa-check"></i><b>4</b> Parts</a></li>
<li class="chapter" data-level="5" data-path="footnotes-and-citations.html"><a href="footnotes-and-citations.html"><i class="fa fa-check"></i><b>5</b> Footnotes and citations</a>
<ul>
<li class="chapter" data-level="5.1" data-path="footnotes-and-citations.html"><a href="footnotes-and-citations.html#footnotes"><i class="fa fa-check"></i><b>5.1</b> Footnotes</a></li>
<li class="chapter" data-level="5.2" data-path="footnotes-and-citations.html"><a href="footnotes-and-citations.html#citations"><i class="fa fa-check"></i><b>5.2</b> Citations</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="blocks.html"><a href="blocks.html"><i class="fa fa-check"></i><b>6</b> Blocks</a>
<ul>
<li class="chapter" data-level="6.1" data-path="blocks.html"><a href="blocks.html#equations"><i class="fa fa-check"></i><b>6.1</b> Equations</a></li>
<li class="chapter" data-level="6.2" data-path="blocks.html"><a href="blocks.html#theorems-and-proofs"><i class="fa fa-check"></i><b>6.2</b> Theorems and proofs</a></li>
<li class="chapter" data-level="6.3" data-path="blocks.html"><a href="blocks.html#callout-blocks"><i class="fa fa-check"></i><b>6.3</b> Callout blocks</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="sharing-your-book.html"><a href="sharing-your-book.html"><i class="fa fa-check"></i><b>7</b> Sharing your book</a>
<ul>
<li class="chapter" data-level="7.1" data-path="sharing-your-book.html"><a href="sharing-your-book.html#publishing"><i class="fa fa-check"></i><b>7.1</b> Publishing</a></li>
<li class="chapter" data-level="7.2" data-path="sharing-your-book.html"><a href="sharing-your-book.html#pages"><i class="fa fa-check"></i><b>7.2</b> 404 pages</a></li>
<li class="chapter" data-level="7.3" data-path="sharing-your-book.html"><a href="sharing-your-book.html#metadata-for-sharing"><i class="fa fa-check"></i><b>7.3</b> Metadata for sharing</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Virus Total</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="analizando-el-ssdeep" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Analizando el <em>ssdeep</em><a href="analizando-el-ssdeep.html#analizando-el-ssdeep" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Las funciones <em>hash</em> como <em>MD5</em>, <em>SHA256</em> o otras son útiles si queremos verificar la integridad de un archivo, su principio fundamental es que un pequeño cambio en el archivo (del orden de unos pocos bits) cambia la salida drásticamente.</p>
<p>En nuestro caso si queremos encontrar similitud entre <em>malware</em> no podemos usar esas funciones, porque si sabemos con certeza de que cierto archivo es peligroso y tenemos su hash calculado, con cambiar un bit de ese archivo ya no lo podríamos detectar.</p>
<p>Por ello existe el programa <em>ssdeep</em>, que permite observar pequeñas diferencias entre archivos calculando el <em>CTPH</em> (parecido al <em>hash</em>).</p>
<div id="sample1.c" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> sample1.c<a href="analizando-el-ssdeep.html#sample1.c" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb27"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb27-1"><a href="analizando-el-ssdeep.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb27-2"><a href="analizando-el-ssdeep.html#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="analizando-el-ssdeep.html#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb27-4"><a href="analizando-el-ssdeep.html#cb27-4" aria-hidden="true" tabindex="-1"></a>  printf <span class="op">(</span>“Hello World”<span class="op">);</span></span>
<span id="cb27-5"><a href="analizando-el-ssdeep.html#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="sample2.c" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> sample2.c<a href="analizando-el-ssdeep.html#sample2.c" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb28"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb28-1"><a href="analizando-el-ssdeep.html#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb28-2"><a href="analizando-el-ssdeep.html#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="dt">int</span> main<span class="op">(</span><span class="dt">int</span> argc<span class="op">,</span> <span class="dt">char</span> <span class="op">*</span>argv<span class="op">[])</span> <span class="op">{</span></span>
<span id="cb28-3"><a href="analizando-el-ssdeep.html#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">100</span><span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb28-4"><a href="analizando-el-ssdeep.html#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="analizando-el-ssdeep.html#cb28-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="op">(</span>i<span class="op">%</span><span class="dv">2</span> <span class="op">==</span> <span class="dv">0</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb28-6"><a href="analizando-el-ssdeep.html#cb28-6" aria-hidden="true" tabindex="-1"></a>                i <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb28-7"><a href="analizando-el-ssdeep.html#cb28-7" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb28-8"><a href="analizando-el-ssdeep.html#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span>
<span id="cb28-9"><a href="analizando-el-ssdeep.html#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb28-10"><a href="analizando-el-ssdeep.html#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
</div>
<div id="sample3.c" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> sample3.c<a href="analizando-el-ssdeep.html#sample3.c" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb29"><pre class="sourceCode c"><code class="sourceCode c"><span id="cb29-1"><a href="analizando-el-ssdeep.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="pp">#include </span><span class="im">&lt;stdio.h&gt;</span></span>
<span id="cb29-2"><a href="analizando-el-ssdeep.html#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="analizando-el-ssdeep.html#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="dt">void</span> main<span class="op">()</span> <span class="op">{</span></span>
<span id="cb29-4"><a href="analizando-el-ssdeep.html#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">int</span> a <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb29-5"><a href="analizando-el-ssdeep.html#cb29-5" aria-hidden="true" tabindex="-1"></a>  printf <span class="op">(</span>“Hello World<span class="op">:</span> <span class="op">%</span>d\n”<span class="op">,</span> a<span class="op">);</span></span>
<span id="cb29-6"><a href="analizando-el-ssdeep.html#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>Ahora calculamos y comparamos el <em>ssdeep</em> de los tres programas:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb30-1"><a href="analizando-el-ssdeep.html#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> ssdeep <span class="at">-s</span> <span class="pp">*</span> <span class="op">&gt;</span> sample_ctph.ssd</span>
<span id="cb30-2"><a href="analizando-el-ssdeep.html#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="ex">$</span> ssdeep <span class="at">-m</span> sample_ctph.ssd <span class="at">-s</span> <span class="pp">*</span></span></code></pre></div>
<p>Obtenemos lo siguiente:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb31-1"><a href="analizando-el-ssdeep.html#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="ex">sample1</span> matches sample_ctph.ssd:/home/samuel/Documentos/LCC/pruebas/sample1 <span class="er">(</span><span class="ex">100</span><span class="kw">)</span></span>
<span id="cb31-2"><a href="analizando-el-ssdeep.html#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="ex">sample1</span> matches sample_ctph.ssd:/home/samuel/Documentos/LCC/pruebas/sample2 <span class="er">(</span><span class="ex">63</span><span class="kw">)</span></span>
<span id="cb31-3"><a href="analizando-el-ssdeep.html#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="ex">sample1</span> matches sample_ctph.ssd:/home/samuel/Documentos/LCC/pruebas/sample3 <span class="er">(</span><span class="ex">80</span><span class="kw">)</span></span></code></pre></div>
<p>sample1.c es mucho más parecido a sample3.c (en un 80%, mientras que solo un 63% con sample2.c).</p>
</div>
<div id="analizando-los-json" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Analizando los json<a href="analizando-el-ssdeep.html#analizando-los-json" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Para analizar nuestros <em>json</em>, desarrollamos primero la siguiente función que para cada archivo saca su <em>sdeep</em> y crea un <em>dataframe</em>:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="analizando-el-ssdeep.html#cb32-1" aria-hidden="true" tabindex="-1"></a>path <span class="ot">&lt;-</span> <span class="st">&quot;~/Documentos/LCC/ProyectoVT/Proyecto/Android2/&quot;</span></span>
<span id="cb32-2"><a href="analizando-el-ssdeep.html#cb32-2" aria-hidden="true" tabindex="-1"></a>nombres_ficheros <span class="ot">&lt;-</span> <span class="fu">list.files</span>(path)</span>
<span id="cb32-3"><a href="analizando-el-ssdeep.html#cb32-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;~/Documentos/LCC/ProyectoVT/Proyecto/virusTotal.csv&quot;</span>)</span></code></pre></div>
<pre><code>## New names:
## Rows: 183 Columns: 10
## ── Column specification
## ──────────────────────────────────────────────────────── Delimiter: &quot;,&quot; chr
## (2): submission.submitter_country, additional_info.exiftool.FileType dbl (6):
## ...1, total, size, times_submitted, positives, Year dttm (2): scan_date,
## first_seen
## ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
## Specify the column types or set `show_col_types = FALSE` to quiet this message.
## • `` -&gt; `...1`</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="analizando-el-ssdeep.html#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#df_deep &lt;- read.csv(&quot;~/Documentos/LCC/ProyectoVT/Proyecto/analisis_ssdeep.csv&quot;)</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="analizando-el-ssdeep.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Entrada: json</span></span>
<span id="cb35-2"><a href="analizando-el-ssdeep.html#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="co"># Salida: dataframe </span></span>
<span id="cb35-3"><a href="analizando-el-ssdeep.html#cb35-3" aria-hidden="true" tabindex="-1"></a>get_ssdeep <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb35-4"><a href="analizando-el-ssdeep.html#cb35-4" aria-hidden="true" tabindex="-1"></a>  json <span class="ot">&lt;-</span> <span class="fu">read_json</span>(x)</span>
<span id="cb35-5"><a href="analizando-el-ssdeep.html#cb35-5" aria-hidden="true" tabindex="-1"></a>  res <span class="ot">&lt;-</span> json <span class="sc">%&gt;%</span> <span class="fu">gather_object</span>() <span class="sc">%&gt;%</span> <span class="fu">filter</span>(name <span class="sc">==</span> <span class="st">&#39;ssdeep&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">as.data.frame</span>()  </span>
<span id="cb35-6"><a href="analizando-el-ssdeep.html#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span> (res)</span>
<span id="cb35-7"><a href="analizando-el-ssdeep.html#cb35-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-8"><a href="analizando-el-ssdeep.html#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="analizando-el-ssdeep.html#cb35-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Por cada archivo en la carpeta Android</span></span>
<span id="cb35-10"><a href="analizando-el-ssdeep.html#cb35-10" aria-hidden="true" tabindex="-1"></a><span class="co"># coge su ssdeep y los guarda en un dataframe</span></span>
<span id="cb35-11"><a href="analizando-el-ssdeep.html#cb35-11" aria-hidden="true" tabindex="-1"></a>df_deep <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb35-12"><a href="analizando-el-ssdeep.html#cb35-12" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> nombres_ficheros) {</span>
<span id="cb35-13"><a href="analizando-el-ssdeep.html#cb35-13" aria-hidden="true" tabindex="-1"></a>  df_deep <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df_deep, <span class="fu">get_ssdeep</span>(<span class="fu">paste0</span>(path,i)))</span>
<span id="cb35-14"><a href="analizando-el-ssdeep.html#cb35-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb35-15"><a href="analizando-el-ssdeep.html#cb35-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-16"><a href="analizando-el-ssdeep.html#cb35-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Limpia el dataframe</span></span>
<span id="cb35-17"><a href="analizando-el-ssdeep.html#cb35-17" aria-hidden="true" tabindex="-1"></a>df_deep <span class="ot">&lt;-</span> df_deep <span class="sc">%&gt;%</span> <span class="fu">select</span>(..JSON)</span>
<span id="cb35-18"><a href="analizando-el-ssdeep.html#cb35-18" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df_deep) <span class="ot">&lt;-</span> (<span class="st">&#39;ssdeep&#39;</span>)</span></code></pre></div>
<p>Leemos los dataframes, <em>df</em> tiene todos los <em>json</em> preprocesados, y <em>df_deep</em> los <em>hashes CTPH</em>:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="analizando-el-ssdeep.html#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Coge los virus cuya distancia (parecido)</span></span>
<span id="cb36-2"><a href="analizando-el-ssdeep.html#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="co"># en sus ssdeep sea menor que 2</span></span>
<span id="cb36-3"><a href="analizando-el-ssdeep.html#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="co"># y los guarda en *indices*</span></span>
<span id="cb36-4"><a href="analizando-el-ssdeep.html#cb36-4" aria-hidden="true" tabindex="-1"></a>indices <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb36-5"><a href="analizando-el-ssdeep.html#cb36-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(df_deep)) {</span>
<span id="cb36-6"><a href="analizando-el-ssdeep.html#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> (i<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span><span class="fu">nrow</span>(df_deep)) {</span>
<span id="cb36-7"><a href="analizando-el-ssdeep.html#cb36-7" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> ( <span class="fu">adist</span>(df_deep[i,], df_deep[j,]) <span class="sc">==</span> <span class="dv">1</span>) {</span>
<span id="cb36-8"><a href="analizando-el-ssdeep.html#cb36-8" aria-hidden="true" tabindex="-1"></a>      indices <span class="ot">&lt;-</span> <span class="fu">c</span>(indices, i,j)</span>
<span id="cb36-9"><a href="analizando-el-ssdeep.html#cb36-9" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb36-10"><a href="analizando-el-ssdeep.html#cb36-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-11"><a href="analizando-el-ssdeep.html#cb36-11" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="analizando-el-ssdeep.html#cb37-1" aria-hidden="true" tabindex="-1"></a>M <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">nrow</span>(df), <span class="at">ncol =</span> <span class="fu">nrow</span>(df))</span>
<span id="cb37-2"><a href="analizando-el-ssdeep.html#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="analizando-el-ssdeep.html#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(indices)<span class="sc">-</span><span class="dv">1</span>) {</span>
<span id="cb37-4"><a href="analizando-el-ssdeep.html#cb37-4" aria-hidden="true" tabindex="-1"></a>  M[indices[i],indices[i<span class="sc">+</span><span class="dv">1</span>]] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb37-5"><a href="analizando-el-ssdeep.html#cb37-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb37-6"><a href="analizando-el-ssdeep.html#cb37-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-7"><a href="analizando-el-ssdeep.html#cb37-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-8"><a href="analizando-el-ssdeep.html#cb37-8" aria-hidden="true" tabindex="-1"></a>G <span class="ot">&lt;-</span> <span class="fu">graph_from_adjacency_matrix</span>(M, <span class="at">mode=</span><span class="fu">c</span>(<span class="st">&#39;undirected&#39;</span>))</span>
<span id="cb37-9"><a href="analizando-el-ssdeep.html#cb37-9" aria-hidden="true" tabindex="-1"></a>Isolated <span class="ot">=</span> <span class="fu">which</span>(<span class="fu">degree</span>(G)<span class="sc">==</span><span class="dv">0</span>)</span>
<span id="cb37-10"><a href="analizando-el-ssdeep.html#cb37-10" aria-hidden="true" tabindex="-1"></a>G2 <span class="ot">=</span> <span class="fu">delete.vertices</span>(G, Isolated)</span>
<span id="cb37-11"><a href="analizando-el-ssdeep.html#cb37-11" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(G2, <span class="at">edge.label=</span><span class="fu">rep</span>(<span class="dv">1</span>, <span class="fu">length</span>(indices)), <span class="at">vertex.color=</span><span class="st">&#39;green&#39;</span>, <span class="at">edge.curved =</span> .<span class="dv">1</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="cross.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/01-samuel.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
